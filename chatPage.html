<div class="flexbox">
    <div class="chat-box">
        <div class="chat-box-header">
            <h3> Aggie Chat<br /><small>Last active: 3 min ago</small></h3>
        </div>
        <div id="chat_box_body" class="chat-box-body">
            <div id="chat_messages">
                <div class="profile other-profile">
                    <img src="https://images.unsplash.com/photo-1537396123722-b93d0acd8848?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0NTg5fQ&s=efc6e85c24d3cfdd15cd36cb8a2471ed"
                        width="30" height="30" />
                    <span>William Martinez</span>
                </div>
                <div class="message other-message">
                    Howdy
                </div>


                <div class="profile my-profile">
                    <span>aggieRadio</span>
                    <img src="https://images.unsplash.com/photo-1534135954997-e58fbd6dbbfc?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0NTg5fQ&s=02d536c38d9cfeb4f35f17fdfaa36619"
                        width="30" height="30" />
                </div>
                <div class="message my-message">
                    Howdy!
                </div>
                <div class="message my-message">
                    I saw that we are studying the same class in the MSC! Do you want to study together?
                </div>
            </div>

        </div>
        <div id="typing">
            <div><span></span> <span></span> <span></span> <span class="n">Someone</span> is typing...</div>
        </div>
        <div class="chat-box-footer">
            <textarea id="chat_input" placeholder="Enter your message here..."></textarea>
            <button id="send">
                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                    <path fill="#006ae3" d="M2,21L23,12L2,3V10L17,12L2,14V21Z" />
                </svg>
            </button>
        </div>
    </div>
</div>

<style>
   
   @import url("https://fonts.googleapis.com/css?family=Raleway:400,400i,700");
html, body, h1, h2, h3, h4, h5, h6, p, ul, li, button {
  padding: 0;
  margin: 0;
}

html, body, .flexbox { 
  background-image: url(https://media.tenor.com/RRhijk6pHAoAAAAd/good-morning.gif);
  background-size: cover;
  width: 100%;
  height: 100%;
}

body {
  color: #2f2f2f;
  font-family: Raleway, sans-serif;
  font-size: 16px;
}

.flexbox {
  background-color:maroon;
  display: flex;
  justify-content: center;
  align-items: center;
}

.chat-box {
  background-color: #fff;
  margin: 20px;
  width: 100%;
  height: 100%;
  max-height: calc(100% - 40px);
  display: flex;
  flex-direction: column;
  border-radius: 13px;
  box-shadow: 0 5px 8px rgba(0, 0, 0, 0.3);
}
.chat-box > .chat-box-header {
  width: 100%;
  padding: 20px 15px;
  border-bottom: solid 1px #cfcfcf;
  box-sizing: border-box;
}
.chat-box > .chat-box-body {
  height: 100%;
  display: flex;
  overflow: auto;
  display: flex;
  flex-direction: column;
}
.chat-box > .chat-box-body #chat_messages {
  width: 100%;
  padding: 20px 15px;
  margin-top: auto;
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
}
.chat-box > .chat-box-body #chat_messages .message {
  width: 80%;
  padding: 20px 15px;
  margin: 2px 0;
  overflow: hidden;
  border-radius: 13px;
  transition: height 0.3s ease-in-out;
}
.chat-box > .chat-box-body #chat_messages .message.hide {
  height: 0;
}
.chat-box > .chat-box-body #chat_messages .my-message {
  color: #fff;
  background-color: maroon;
  align-self: flex-end;
}
.chat-box > .chat-box-body #chat_messages .other-message {
  background-color: #e2e2e2;
}
.chat-box > .chat-box-body #chat_messages .profile {
  margin: 2px 0;
  overflow: hidden;
  transition: height 0.3s ease-in-out;
}
.chat-box > .chat-box-body #chat_messages .profile.hide {
  height: 0;
}
.chat-box > .chat-box-body #chat_messages .profile img {
  display: inline-block;
  margin: 0;
  padding: 0;
  vertical-align: middle;
  border-radius: 50%;
}
.chat-box > .chat-box-body #chat_messages .my-profile {
  color: #afafaf;
  align-self: flex-end;
}
.chat-box > .chat-box-body #chat_messages .other-profile {
  color: #afafaf;
}
.chat-box #typing {
  color: #afafaf;
  width: 100%;
  height: 0;
  padding: 0 15px;
  overflow: hidden;
  box-sizing: border-box;
  opacity: 0;
  transition: 0.3s height ease-in-out, 0.3s opacity ease-in-out;
}
.chat-box #typing.active {
  height: 80px;
  opacity: 1;
}
.chat-box #typing span:not(.n) {
  background-color: #afafaf;
  width: 10px;
  height: 10px;
  margin-top: 20px;
  display: inline-block;
  border-radius: 50%;
}
.chat-box #typing span:not(.n):nth-child(1) {
  animation: typing 1.2s infinite;
}
.chat-box #typing span:not(.n):nth-child(2) {
  animation: typing 1.2s infinite 0.1s;
}
.chat-box #typing span:not(.n):nth-child(3) {
  animation: typing 1.2s infinite 0.2s;
}
.chat-box > .chat-box-footer {
  width: 100%;
  padding: 20px 15px;
  border-top: solid 1px #cfcfcf;
  box-sizing: border-box;
  display: flex;
}
.chat-box > .chat-box-footer > #chat_input {
  color: #2f2f2f;
  font-family: Raleway, sans-serif;
  font-size: 16px;
  background-color: #d2d2d2;
  width: 100%;
  height: 40px;
  max-height: 120px;
  border: none;
  padding: 10px 15px;
  resize: none;
  box-sizing: border-box;
  border-radius: 13px;
  transition: 0.3s background-color;
}
.chat-box > .chat-box-footer > #chat_input:focus {
  background-color: #efefef;
}
.chat-box > .chat-box-footer > #send {
  background: none;
  border: none;
  margin-left: 10px;
  padding: 5px;
  cursor: pointer;
  border-radius: 50%;
}

@media (min-width: 480px) {
  .chat-box {
    width: 480px;
  }
}
@keyframes typing {
  0% {
    transform: translateY(0px);
  }
  33.3333% {
    transform: translateY(-5px);
  }
  66.6667% {
    transform: translateY(5px);
  }
  100% {
    transform: translateY(0px);
  }
}
button::-moz-focus-inner {
  border-style: none;
  padding: 0;
}

button {
  outline: none;
}

h3 > small {
  color: #afafaf;
  font-weight: normal;
}





</style>

<script>
    'use strict';

    var chatInput = document.querySelector('#chat_input');
    var typing = document.querySelector('#typing');
    var send = document.querySelector('#send');
    var chatMessages = document.querySelector('#chat_messages');
    var chatBoxBody = document.querySelector('#chat_box_body');
    var chatThread = {};

    // ----- EVENTS ----- //

    chatInput.addEventListener('input', function () {
        this.style.height = '0';
        this.style.height = this.scrollHeight + 1 + 'px';
    });

    chatInput.addEventListener('keydown', function (evt) {
        if (evt.keyCode == 13 && !evt.shiftKey) {
            sendMessage('my', this);
            evt.preventDefault();
        }
    });

    send.addEventListener('click', function () {
        sendMessage('my', chatInput);
    });

    // ----- FUNCTIONS -----//

    function renderProfile(p) {
        return '<div class="profile ' + p + '-profile hide"><img src="' + profile[p].pic + '" alt="' + profile[p].name + '" width="30" height="30" />&nbsp;<span>' + profile[p].name + '</span></div>';
    }

    function renderMessage(p, m) {
        return '<div class="message ' + p + '-message hide">' + m + '</div>';
    }

    function appendMessage(r) {
        chatMessages.insertAdjacentHTML('beforeend', r);

        var elms = document.querySelectorAll('.profile.hide, .message.hide');

        for (var i = 0; i < elms.length; i++) {
            if (elms[i].classList.contains('profile')) {
                elms[i].style.height = elms[i].scrollHeight + 'px';
            }
            else {
                elms[i].style.height = elms[i].scrollHeight - 20 + 'px';
            }

            elms[i].classList.remove('hide');
        }

        chatBoxBody.scrollTop = chatBoxBody.scrollHeight;
    }

    function sendMessage(p, elm) {
        var r = '';

        if (chatThread[chatThread.length - 1].profile !== p) {
            r += renderProfile(p);
        }

        if (typeof elm === 'string') {
            r += renderMessage(p, elm);

            chatThread.push({
                'profile': p,
                'message': elm
            });
        }
        else {
            r += renderMessage(p, elm.value);

            chatThread.push({
                'profile': p,
                'message': elm.value
            });

            elm.value = '';
        }

        appendMessage(r);
    }

    chatBoxBody.scrollTop = chatBoxBody.scrollHeight;

    // ---------- Example ---------- //

    profile = {
        'my': {
            'name': 'My profile',
            'pic': 'https://images.unsplash.com/photo-1534135954997-e58fbd6dbbfc?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0NTg5fQ&s=02d536c38d9cfeb4f35f17fdfaa36619'
        },
        'other': {
            'name': 'Other profile',
            'pic': 'https://images.unsplash.com/photo-1537396123722-b93d0acd8848?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0NTg5fQ&s=efc6e85c24d3cfdd15cd36cb8a2471ed'
        }
    };

    chatThread = [{
        'profile': 'other',
        'message': 'Hello!'
    }, {
        'profile': 'my',
        'message': 'Hi!'
    }, {
        'profile': 'my',
        'message': 'How are you?'
    }];

    (function autoText() {
        setTimeout(function () {
            typing.classList.add('active');

            setTimeout(function () {
                var randomMessages = ['Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.', 'Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.', 'Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.', 'Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'];

                sendMessage('other', randomMessages[Math.floor(Math.random() * 4)]);

                typing.classList.remove('active');

                autoText();
            }, 8000);
        }, 3000);
    })();

</script>
